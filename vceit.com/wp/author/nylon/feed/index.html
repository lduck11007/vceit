<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Mark Kelly &#8211; VCE IT Lecture Notes by Mark Kelly</title>
	<atom:link href="http://vceit.com/wp/author/nylon/feed/" rel="self" type="application/rss+xml" />
	<link>http://vceit.com/wp</link>
	<description>Informatics, Software Development, Computing</description>
	<lastBuildDate>Thu, 22 Feb 2018 04:43:50 +0000</lastBuildDate>
	<language>en-AU</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	
	<item>
		<title>Avoiding Nested IFs in Excel</title>
		<link>http://vceit.com/wp/avoiding-nested-ifs-in-excel/</link>
				<comments>http://vceit.com/wp/avoiding-nested-ifs-in-excel/#respond</comments>
				<pubDate>Fri, 27 Nov 2015 01:46:18 +0000</pubDate>
		<dc:creator><![CDATA[Mark Kelly]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://vceit.com/wp/?p=986</guid>
				<description><![CDATA[How to avoid nested IFs in Excel Â This site might also help explain how to use VLOOKUP Â  Some people insist on doing things the hard way &#8211; such as using nested IF statements in Excel to handle multi-condition behaviours. Quite simply &#8211; you hardly EVER have to use nested IF constructs&#8230; I went Googling &#8230; <a href="http://vceit.com/wp/avoiding-nested-ifs-in-excel/" class="more-link">Continue reading <span class="screen-reader-text">Avoiding Nested IFs in Excel</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<h1 style="text-align: center;">How to<br />
avoid nested IFs <br />
in Excel</h1>
<div align="center">Â <a href="https://spreadsheeto.com/vlookup/">This site might also help explain how to use VLOOKUP</a></div>
<div align="center">Â </div>
<table border="1" cellspacing="0" cellpadding="3">
<tbody>
<tr>
<td>Some people insist on doing things the hard way &#8211; such as using nested IF statements in Excel to handle multi-condition behaviours. Quite simply &#8211; you hardly EVER have to use nested IF constructs&#8230; I went Googling to try and find a really good case of where a nested IF was essential.</td>
</tr>
<tr>
<td>
<h3>CASE 1</h3>
<p>My first Googling found&#8230;Â <a href="http://www.cpearson.com/excel/nested.htm">http://www.cpearson.com/excel/nested.htm</a> It presents the case of&#8230;</p>
<p><i>Suppose we wanted an nested IF formula to test: <br />
IF A4 = 1 Then 11 Else IfÂ Â  A4 = 2 Then 22 Else IfÂ Â  A4 = 3 Then 33 Else IfÂ Â  A4 = 4 Then 44 &#8230; Else IfÂ Â  A4 = 13 Then 130Â  Else &#8220;Not Found&#8221;</i></p>
<p><span style="color: #000000;">The author then creates a massively complicated IF solution. This is an example of where you just would not use nested IF at all. You would use VLOOKUP.Â  Since the lookup values are simply 1 to 13, justÂ use: </span></p>
<table border="1" width="25%" cellspacing="0" cellpadding="6">
<tbody>
<tr>
<td width="41%"><b>IF A4=</b></td>
<td width="59%"><b>RETURN VALUE</b></td>
</tr>
<tr>
<td>1</td>
<td>11</td>
</tr>
<tr>
<td>2</td>
<td>22</td>
</tr>
<tr>
<td>3</td>
<td>33</td>
</tr>
<tr>
<td>4</td>
<td>44</td>
</tr>
<tr>
<td>..</td>
<td>..</td>
</tr>
<tr>
<td>13</td>
<td>Not found</td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;"> Name the above range &#8220;table&#8221; and use =VLOOKUP(A4,table,2) </span> <span style="color: #000000;"> Far better than twisting yourself up with IF&#8230; </span></td>
</tr>
<tr>
<td>
<h4><a name="choose"></a>Another strategy</h4>
<p>The CHOOSE() function also lets you easily look up values for an index value e.g. =CHOOSE(daynumber,&#8221;Sunday&#8221;,&#8221;Monday&#8221;,&#8221;Tuesday&#8221;&#8230; etc) That may be useful too!</td>
</tr>
<tr>
<td>
<h3>CASE 2</h3>
<p>My second Google led to&#8230; <a href="http://spreadsheets.about.com/cs/excelfunction1/a/nestediffunct.htm">http://spreadsheets.about.com/cs/excelfunction1/a/nestediffunct.htm</a> It says&#8230; <i>To illustrate, let&#8217;s say you have a spreadsheet thatÂ you use to keepÂ track of your sales force. The rate of commission each sales personÂ receives is based on the amount of sales they have generated for that month. For example: </i> <i>From $1 to $10 earns 10% commission From $11 to $100 earns 15% commission Anything over $100 earns 20% commission </i> <i>Assuming the amount of sales is in column B, startingÂ at row 4, andÂ that the column containing the commission is formated for percentages,Â thisÂ is what the nested IF function would look like: </i></p>
<p><i>=IF(B4&lt;=10,&#8221;10&#8243;, if(b4&lt;=100, &#8220;15&#8221;, &#8220;20&#8221;)) </i></p>
<p><span style="color: #000000;">Once again, a simple VLOOKUP is far superior. </span></p>
<table border="1" cellspacing="0" cellpadding="6">
<tbody>
<tr>
<td><b>FROM</b></td>
<td><b>TO</b></td>
<td><b>COMMISSION</b></td>
</tr>
<tr>
<td>1</td>
<td>10</td>
<td>10%</td>
</tr>
<tr>
<td>11</td>
<td>100</td>
<td>15%</td>
</tr>
<tr>
<td>101</td>
<td>&nbsp;</td>
<td>20%</td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">Name the range (excluding headings) &#8220;table&#8221; and then use =VLOOKUP(sales,table,3)</span> <span style="color: #000000;">(Assuming the value to look up is in a cell named &#8220;sales&#8221;) </span></td>
</tr>
<tr>
<td>
<h5>NOTE</h5>
<p>Note the method I now use for setting out lookup tables.Â  IÂ used to getÂ mental cramps working out the cutoff values for categories.Â  Now I use &#8220;From&#8221; and &#8220;To&#8221; columns to make it much easier to determine the numbers. The second column is actually never used by the lookup, but it helpsÂ my brain.Â  Life is so much more pleasant nowÂ  <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></td>
</tr>
<tr>
<td>
<h3>CASE 3</h3>
<p>Example 3, found at <a href="http://www.techonthenet.com/excel/formulas/if_nested.htm">http://www.techonthenet.com/excel/formulas/if_nested.htm</a> <i>Question:Â  In Excel, I need to write a formula that works thisÂ way: </i></p>
<p>Â If (cell A1) is less than 20, then times it by 1, &gt;</p>
<p>If it is greater than or equal to 20 but less than 50, then times it byÂ 2 &gt;</p>
<p>If it is greater than or equal to 50 and less than 100, then times itÂ by 3Â </p>
<p>And if it is great or equal to than 100, then times it by 4 <i>&gt;</i></p>
<p><i>Answer:Â  You can write a nested IF statement to handle this.Â  ForÂ example:Â </i></p>
<p><i> =IF(A1&lt;20, A1*1, IF(A1&lt;50, A1*2, IF(A1&lt;100, A1*3, A1*4))) </i> <span style="color: #000000;">Once again, it&#8217;s far easier to use &#8230; </span></p>
<table border="1" cellspacing="0" cellpadding="6">
<tbody>
<tr>
<td><b>From</b></td>
<td><b>To</b></td>
<td><b>Multiplier</b></td>
</tr>
<tr>
<td>0</td>
<td>19</td>
<td>1</td>
</tr>
<tr>
<td>20</td>
<td>49</td>
<td>2</td>
</tr>
<tr>
<td>50</td>
<td>99</td>
<td>3</td>
</tr>
<tr>
<td>100</td>
<td>&nbsp;</td>
<td>4</td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">Name the range &#8220;table&#8221; (or whatever) </span> In the target cell just put <span style="color: #000000;">=A1 * VLOOKUP(A1,table,3) </span></td>
</tr>
<tr>
<td>
<h3>CASE 4</h3>
<p>Example 4, found at <a href="http://www.techonthenet.com/excel/macros/if_custom.htm">http://www.techonthenet.com/excel/macros/if_custom.htm</a> <i>&gt; Question:Â  I have a formula in Excel that I am using toÂ test for 7 conditions, and each condition if true will return a different value. However, I now need to test a total of 12 possible values.Â  The limitation of the nested IFs is that you can only nest up to 7.Â  Is there an alternative to this formula to test so that I can test for 12 values instead of 7? </i> =IF(A1=&#8221;10X12&#8243;,120,IF(A1=&#8221;8&#215;8&#8243;,64,IF(A1=&#8221;6&#215;6&#8243;,36,IF(A1=&#8221;8&#215;10&#8243;,80,IF(A1=&#8221;14&#215;16&#8243;,224,IF(A1=&#8221;9&#215;9&#8243;,81,IF(A1=&#8221;4&#215;3&#8243;,12)))))))</p>
<p>Answer:Â  There is no built-in alternative formula in Excel, but you could write your own function in VBA and then call this new function &gt; instead. <span style="color: #000000;">Geez!Â  You could (again) use vlookup&#8230; </span></p>
<table border="1" cellspacing="0" cellpadding="6">
<tbody>
<tr>
<td width="39">10&#215;12</td>
<td width="74">120</td>
</tr>
<tr>
<td>14&#215;16</td>
<td>224</td>
</tr>
<tr>
<td>4&#215;3</td>
<td>12</td>
</tr>
<tr>
<td>6&#215;6</td>
<td>36</td>
</tr>
<tr>
<td>8&#215;10</td>
<td>80</td>
</tr>
<tr>
<td>8&#215;8</td>
<td>64</td>
</tr>
<tr>
<td>9&#215;9</td>
<td>81</td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">Sort by the first column so they&#8217;re sorted alphabetically (or see the tip below).Â  CallÂ it &#8220;table&#8221; andÂ use =VLOOKUP(a1,table,2) </span></td>
</tr>
<tr>
<td>
<h5>TIP</h5>
<p>If searching a table for an <b>exact</b> match (e.g. cases 1 and 4) ratherÂ than for a value fitting into a continuous range (e.g. values from 26Â to 73) you can use the mysterious optional parameter in vlookup&#8230;</p>
<p>=VLOOKUP(a1,table,2<b>, FALSE</b>)</p>
<p>By adding the &#8221; ,FALSE&#8221;, vlookup will look for an <i>exact match</i> forÂ the lookup value in the table. Note!Â  It gives an error if the exact valueÂ is not found. Using the extra &#8220;,FALSE&#8221; means you <i>don&#8217;tÂ have to sort the lookup rows</i> into ascending order..</p>
</td>
</tr>
<tr>
<td>In short: I (nearly) <b>never</b> use nested IFs because usually thereÂ are easier and smarter alternatives. Here&#8217;s a challenge: come up with a neatÂ example where it is <b>essential</b> to use nested IFs!Â  <a href="../etc/mailform.htm">Tell me aboutÂ it!</a></td>
</tr>
<tr>
<td valign="top">
<div align="center">
<h2>The IF Challengers</h2>
</div>
</td>
</tr>
<tr>
<td valign="top">
<h3>CHALLENGE 1</h3>
<p>A worthy challenge from yangontha on 28 October 2006. If memory serves me correctly, yangontha said: <em>Column A has a property type and the value ranges from 1 to 5. Column B and C has some decimal values. In each row, depending on the value of type, the different formula is used to calculate for column D. For example, if the type is 1, then the values in column B and C for that row are added and put in column D. If the type is 2, then the values in column B and C for that row are multiplied and put in column D. Depending on the value of type, there is a different formula. The problem is how to put the formula in column D so that the respective formulae is used to calculate for column D</em></p>
<table border="1" width="51%" cellspacing="0" cellpadding="3">
<tbody>
<tr>
<td width="22%"><em>2</em></td>
<td width="16%"><em>4</em></td>
<td width="19%"><em>6</em></td>
<td width="20%"><em>24</em></td>
<td width="23%"><em>multiply</em></td>
</tr>
<tr>
<td><em>1</em></td>
<td><em>8</em></td>
<td><em>28</em></td>
<td><em>36</em></td>
<td><em>add</em></td>
</tr>
<tr>
<td><em>1</em></td>
<td><em>9</em></td>
<td><em>7</em></td>
<td><em>16</em></td>
<td><em>add</em></td>
</tr>
<tr>
<td><em>2</em></td>
<td><em>9</em></td>
<td><em>7</em></td>
<td><em>63</em></td>
<td><em>multiply</em></td>
</tr>
</tbody>
</table>
<p><em>I am not saying, nested if is necessary. But I can&#8217;t think of a way, how to put the formula in column D. </em></p>
<hr />
<p><strong>This is what I replied to yangontha.</strong> <span style="color: #000000;">Hi Yangontha.Â  </span></p>
<p><span style="color: #000000;">Not even a nested IF is required using the sample data you provided. Â </span>There are only 2 operators to cope with (multiply and add) so a simple IF does the trick.</p>
<table border="1" cellspacing="0" cellpadding="3">
<tbody>
<tr>
<td>&nbsp;</td>
<td height="17"><span style="color: #000000;"><strong>A</strong></span></td>
<td><span style="color: #000000;"><strong>B</strong></span></td>
<td><span style="color: #000000;"><strong>C</strong></span></td>
<td><span style="color: #000000;"><strong>D</strong></span></td>
</tr>
<tr>
<td width="39"><span style="color: #000000;"><strong>1</strong></span></td>
<td width="56" height="17"><span style="color: #000000;">2</span></td>
<td width="56"><span style="color: #000000;">4</span></td>
<td width="52"><span style="color: #000000;">6</span></td>
<td width="195"><span style="color: #000000;">=IF(A1=1 , B1+C1 , B1*C1)</span></td>
</tr>
<tr>
<td><span style="color: #000000;"><strong>2</strong></span></td>
<td height="17"><span style="color: #000000;">1</span></td>
<td><span style="color: #000000;">8</span></td>
<td><span style="color: #000000;">28</span></td>
<td><span style="color: #000000;">=IF(A2=1 , B2+C2 , B2*C2)</span></td>
</tr>
<tr>
<td><span style="color: #000000;"><strong>3</strong></span></td>
<td height="17"><span style="color: #000000;">1</span></td>
<td><span style="color: #000000;">9</span></td>
<td><span style="color: #000000;">7</span></td>
<td><span style="color: #000000;">=IF(A3=1 , B3+C3 , B3*C3)</span></td>
</tr>
<tr>
<td><span style="color: #000000;"><strong>4</strong></span></td>
<td height="17"><span style="color: #000000;">2</span></td>
<td><span style="color: #000000;">9</span></td>
<td><span style="color: #000000;">7</span></td>
<td><span style="color: #000000;">=IF(A4=1 , B4+C4 , B4*C4)</span></td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">Mind you, if you added divide and subtract to get four conditions rather than two, a different approach would be needed &#8211; but not VLOOKUP in this case &#8211; you&#8217;d use the <a href="#choose">CHOOSE function (as mentioned above)</a>.</span></p>
<table border="1" width="90%" cellspacing="0" cellpadding="3">
<tbody>
<tr>
<td>&nbsp;</td>
<td height="17"><strong><span style="color: #000000;">A</span></strong></td>
<td><strong><span style="color: #000000;">B</span></strong></td>
<td><strong><span style="color: #000000;">C</span></strong></td>
<td><strong><span style="color: #000000;">D</span></strong></td>
<td><strong><span style="color: #000000;">E</span></strong></td>
</tr>
<tr>
<td width="66"><strong>7</strong></td>
<td width="91" height="17"><strong>Function</strong></td>
<td width="71"><strong>X</strong></td>
<td width="73"><strong>Y</strong></td>
<td width="384"><strong>Answer</strong></td>
<td width="109"><strong>Functions</strong></td>
</tr>
<tr>
<td><strong>8</strong></td>
<td height="17">1</td>
<td>4</td>
<td>6</td>
<td>=CHOOSE(A8 , B8+C8 , B8*C8 , B8/C8 , B8-C8)</td>
<td>1 = +</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td height="17">2</td>
<td>8</td>
<td>28</td>
<td>=CHOOSE(A9 , B9+C9 , B9*C9 , B9/C9 , B9-C9)</td>
<td>2 = *</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td height="17">3</td>
<td>9</td>
<td>7</td>
<td>=CHOOSE(A10 , B10+C10 , B10*C10 , B10/C10 , B10-C10)</td>
<td>3 = /</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td height="17">4</td>
<td>5</td>
<td>2</td>
<td>=CHOOSE(A11 , B11+C11 , B11*C11 , B11/C11 , B11-C11)</td>
<td>4 = &#8211;</td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">It&#8217;s not VLOOKUP, perhaps , but I never said VLOOKUP was the answer for everything. </span></p>
<p><span style="color: #000000;">You always use the best-fitting solution to a problem: you don&#8217;t force the one tool you know into solving <em>every</em> problem.</span> <span style="color: #000000;">Good try , but nested IF is still a beaten foe. <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></span></p>
</td>
</tr>
<tr>
<td valign="top">
<h3>CHALLENGE 2</h3>
<p>&#8216;Curious&#8217; wrote on Saturday, December 30, 2006 at 09:51:40 <i>Hi Mark &#8211; What about if you have a range of dates formatted inÂ date form (i.e. 12/29/2006) and you want Excel to search that range ofÂ data and return the month in text form (i.e. DEC). Isn&#8217;t it necessary to use a nested IF for this case? I tried using a vlookup formula (quite similarÂ to the first example listed on your website) and making a table (namedÂ MONTHS) that defines each month (ex. 1 = Jan, 2 = Feb, and so on)&#8230; namingÂ that table and then using the following vlookup formula: =VLOOKUP(A9,MONTHS,2) I had no luck with this and am convinced that in this instance, aÂ nested IF formula is needed. What do you think? Much appreciated, Curious</i></p>
<hr />
<p><span style="color: #000000;">And I replied: </span> <span style="color: #000000;">Hi curious. You were SO close! The problem you had was that you had not extracted the month from the date to use in the lookup. VLOOKUP will do the job very nicely, with the addition of one simple MONTH( ) functionÂ Â Â  <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></span> <a href="../m/nasty-if-months.xls">Download the Excel solution</a></p>
<p><img class="alignnone size-medium wp-image-219" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months1-300x203.jpg" alt="nasty-if-months1" width="300" height="203" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months1-300x203.jpg 300w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months1.jpg 381w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p><i>The formulas:</i></p>
<p><img class="alignnone wp-image-246 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months2.jpg" alt="nasty-if-months2" width="505" height="128" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months2.jpg 505w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-months2-300x76.jpg 300w" sizes="(max-width: 505px) 100vw, 505px" /></p>
</td>
</tr>
<tr>
<td valign="top">
<h3>CHALLENGE 3</h3>
<p>On 15 August 2007, Jay wrote to say: <i>Here&#8217;s 1, I am having trouble coming up with ANY way of solving: I have 6 columns of data. I want to be able to set up a 7th column that tells me whether I have passed or failed my test criteria (by saying PASS or FAIL). the failing criteria is if 2 or more of the 6 columns display a value less than 85. The nesting IF function can only nest 7, with 15 possible combinations in this example, so thats not even an option. Thanks!</i></p>
<p><span style="color: #000000;">Hi Jay. What about this:</span></p>
<p><span style="color: #000000;">=IF(COUNTIF(A3:F3,&#8221;&lt;85&#8243;)&gt;=2,&#8221;Fail&#8221;,&#8221;Pass&#8221;)</span></p>
<p><span style="color: #000000;">It simply counts the number of cells that are less than 85. If there are 2 or more, they fail.</span></p>
</td>
</tr>
<tr>
<td valign="top">
<h3>CHALLENGE 4</h3>
<p>24 September 2007 <i>Hi,</i> Ok here we go&#8230;.. I have created a MSÂ EXCEL 2007 Workbook that got two sheets. I Â have attached picture of both sheets. in &#8220;Sheet 1&#8221; there is three Field 1. ID:- This is to track the customer ID=1 Means its &#8220;Customer 1&#8243;&#8230;. 2. Bill No:-This is to track Month Bill 1 Means Month=January&#8230; 3.Total Bill:- This is where the problem occurs. <i>In sheet two there is a MATRIX TABLE&#8230;What i need to do is Bring the proper value from sheet2. Like&#8212;- if ID=1 and Bill No=1 then it will show value from B4 in sheet2.</i></p>
<p><a href="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-sol4a.gif"><img class="alignnone size-full wp-image-519" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-sol4a.gif" alt="nasty-if-sol4a" width="214" height="125" /></a> <img class="alignnone wp-image-168 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-sol4b.jpg" alt="nasty-if-sol4b" width="600" height="249" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-sol4b.jpg 600w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-sol4b-300x125.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p>Everything is okÂ . i have the code which is working but within the limit. It only accept 64 Argument or nested IF else. But my requirement is more than that. The Code is Something like that =IF(AND(N13=1,N14=1),Readings!B4,IF(AND(N13=1,N14=),Readings!C4,&#8230;&#8230;&#8230;&#8230;&#8230;.. I heard that there is a way if i make a FUNCTION and call it . But i don&#8217;t now how. if u can help&#8230; Thankx</p>
<p><span style="color: #000000;">And the result is once again far easier than expected, so long as you know what Excel has in its toolbox for you to play with&#8230; </span></p>
<p><span style="color: #000000;">Assuming: &#8211;Â the customer ID cell is named &#8216;customer&#8217; and &#8211;Â the month number cell is named &#8216;month&#8217; and &#8211;Â the table (excluding the heading row and column) is named &#8216;table&#8217;&#8230;</span> <span style="color: #000000;">t</span><span style="color: #000000;">he fomula for the total bill is simply: <b> =INDEX(table,customer,month)</b> </span></p>
<p><span style="color: #000000;">Easy as that. </span></p>
<p><span style="color: #000000;">You can <a href="/m/nasty-if-challenge4.xls">download the solution</a> if you like. </span></p>
</td>
</tr>
<tr>
<td valign="top">
<h3>CHALLENGE 5</h3>
<p>11 October 2007 Sara wrote to say&#8230;</p>
<div><em>Hi Mark:</em></div>
<div><em>I&#8217;m quite intrigued on your battle against the nested ifs!</em></div>
<div><em>Here&#8217;s another challenge&#8230;you haven&#8217;t addressed if the condition meets 2 requirements such as:</em></div>
<div><em>=IF(AND(M11=&#8221;A&#8221;,J11&gt;(TODAY()-1095)&gt;0),&#8221;No&#8221;,&#8221;Yes&#8221;) =IF(AND(M11=&#8221;B&#8221;,J11&gt;(TODAY()-1000)&gt;0),&#8221;No&#8221;,&#8221;Yes&#8221;) =IF(AND(M11=&#8221;C&#8221;,J11&gt;(TODAY()-800)&gt;0),&#8221;No&#8221;,&#8221;Yes&#8221;) =IF(AND(M11=&#8221;D&#8221;,J11&gt;(TODAY()-500)&gt;0),&#8221;No&#8221;,&#8221;Yes&#8221;) =IF(AND(M11=&#8221;E&#8221;,J11&gt;(TODAY()-200)&gt;0),&#8221;No&#8221;,&#8221;Yes&#8221;) </em> <em>and so on&#8230;I&#8217;m driving myself crazy with the ifs&#8230;.could you help? Your solutions and answers to challenges are greatly appreciated!!! </em></div>
<div><em> Take care,</em> <em>Sara</em></div>
<p><span style="color: #000000;">This was an interesting challenge, but solvable with a bit of lateral thinking and a nested LOOKUP. </span> <img class="alignnone wp-image-152 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-hvlookup.jpg" alt="nasty-if-hvlookup" width="738" height="257" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-hvlookup.jpg 738w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-hvlookup-300x104.jpg 300w" sizes="(max-width: 738px) 100vw, 738px" /> <span style="color: #000000;">Entering an arbitrary &#8220;type&#8221; (A-F in this case) into C2 and a &#8220;days ago&#8221; into C2 gives the value matching that combination of days and type. The trick is to use a VLOOKUP with a HLOOKUP (its less famous cousin) inside it. </span> <span style="color: #000000;">The formula in F12 is <strong>=VLOOKUP(C2,E6:F10,2) + 1 </strong></span> <span style="color: #000000;">This handles the first step of the two-part lookup &#8211; it looks up the &#8220;days ago&#8221; value in the table and returns a <em>row number</em> (that&#8217;s the tricky bit). Then, the formula for the answer is <strong>=HLOOKUP(C1,G5:L10,F12)</strong> </span> <span style="color: #000000;">This looks up the &#8220;type&#8221; in a HLOOKUP and uses the previous VLOOKUP&#8217;s value to act as the HLOOKUP&#8217;s <em>row</em> parameter.</span></p>
<p><a href="/m/nasty-if-hvlookup.xls">Download the solution here</a>.</p>
</td>
</tr>
<tr>
<td valign="top">
<h3>Challenge 6</h3>
</td>
</tr>
<tr>
<td valign="top">
<p>I just found this one lurking in the bottom of my hard disk. I must have lost it or forgotten to upload it. Anyway, it&#8217;s an interesting one. Someone wanted to know how to work out salaries that depended on not one but two variables: length of service <em>and</em> education level without the use of tortuous nested IFs. In effect, they wanted to get this&#8230; <img class="alignnone wp-image-211 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree0.jpg" alt="nasty-if-salarydegree0" width="319" height="187" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree0.jpg 319w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree0-300x176.jpg 300w" sizes="(max-width: 319px) 100vw, 319px" /></p>
<p>To solve this required a bit of lateral thinking &#8211; instead of a nested IF, we need a nested lookup! First, we do a normal lookup of years of service to find the right row in the salary table. So James, for example, with 6 years of service is looked up in the B5:E9 table and we find he&#8217;s in row 2 of the table.</p>
<p>The hard bit is to then determine which <em>column</em> we need to read from to get his salary; it depends on the degree he holds. This is where the second lookup happens. The &#8220;column&#8221; parameter of the first lookup will not be a constant &#8211; it will be dynamically calculated by another lookup. The second lookup looks up the person&#8217;s degree in a second table (G6:H8). It returns a number from 2 to 4, which is used to select a column value for the <em>first</em> lookup.</p>
<p><img class="alignnone wp-image-127 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree1.jpg" alt="nasty-if-salarydegree1" width="584" height="379" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree1.jpg 584w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree1-300x195.jpg 300w" sizes="(max-width: 584px) 100vw, 584px" /></p>
<p>The result is something like this:</p>
<p><img class="alignnone wp-image-111 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree2.jpg" alt="nasty-if-salarydegree2" width="1134" height="376" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree2.jpg 1134w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree2-300x99.jpg 300w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-salarydegree2-1024x340.jpg 1024w" sizes="(max-width: 1134px) 100vw, 1134px" /></p>
<p>Note the extra fourth parameter in the nested lookup &#8211; it allows the degrees to be in any order rather than sorted alphabetically. <a href="/m/nasty-if-salary-degree.xls">Download the Excel source.</a></p>
</td>
</tr>
<tr>
<td valign="top">
<h3>Â CHALLENGE 7</h3>
<p>Loti wrote in 2008&#8230; <em>I am an HR Officer responsible for recruiting employees for a Mining company that has a workforce of 1800 employees. I maintain an employee data base in excel. I want to create a column in the database, where I will be able to know if an employee is due for the first probation assessment after 3 months. </em> <em>If, after being assessed, the employee is not ready for confirmation I would like to indicate in the next column that &#8220;Emp. is Not Ready&#8221; and after another 3 months the employee should be subjected to a 2nd assessment. </em> <em>If after the first assessment, the employee is deemed suitable for the position, I should indicated &#8216;Confirmed&#8221; in the next column to close the chapter on that particular employee.</em> <em> What functions can I use to know (1) when an employee is due for the first assessment, (2) if employee is not subjected to the first assessment after 3 months that the 1st assessment is overdue, and (3) when the 2nd assessment is due. I have attached part of the database for you to fully understand my problem. Regards Loti </em> <span style="color: #000000;">The sample spreadsheet attached had some quite lengthy nested IF statements such as&#8230;</span></p>
<p><span style="color: #000000;">=IF((DATEDIF(C4,TODAY(),&#8221;d&#8221;))&gt;80,IF(((DATEDIF(C4,TODAY(),&#8221;d&#8221;)))&lt;91,&#8221;Due&#8221;,IF(((DATEDIF(C4,TODAY(),&#8221;d&#8221;)))&lt;180,IF(ISBLANK(E4),&#8221;Over due&#8221;,&#8221;&#8221;),&#8221;&#8221;)))</span></p>
<p><span style="color: #000000;">It took a bit of fiddling and head scratching to work out the logic of the problem. It was interesting because there were several logical tests to consider:</span> <span style="color: #000000;">How long has the person been employed?</span> <span style="color: #000000;">Have they been confirmed yet?</span> <span style="color: #000000;">Have they been assessed yet?</span></p>
<p><span style="color: #000000;">Again, I thought, <strong>VLOOKUP</strong> and his magical pony can save the day. With a relatively simple IF, a VLOOKUP and a super-sneaky IF <em>inside</em> the VLOOKUP we can test for multiple conditions in one sweet package&#8230;</span></p>
<p><img class="alignnone wp-image-135 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation1.jpg" alt="nasty-if-probation1" width="735" height="348" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation1.jpg 735w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation1-300x142.jpg 300w" sizes="(max-width: 735px) 100vw, 735px" /></p>
<p><span style="color: #000000;">Column A is Date of Employment. Note that in this test data I fixed &#8220;today&#8221; to a particular date so the result would not vary over time. One would use the TODAY( ) function for the real thing.</span></p>
<p><span style="color: #000000;">The important column is B &#8211; status. If they have not been employed for 90 days, they are not due for assessment.</span> <span style="color: #000000;">If they have been employed 90 to 179 days, and they have not been assessed, their status is &#8220;due for first assessment&#8221;. If they had been assessed but not confirmed, they would be shown as &#8220;Not ready 1&#8221;. </span></p>
<p><span style="color: #000000;">You can see how complex this is getting. Nested IF was simply not up to the task. This is how I did it&#8230;</span></p>
<p><img class="alignnone wp-image-126 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation2.jpg" alt="nasty-if-probation2" width="857" height="345" srcset="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation2.jpg 857w, http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-probation2-300x121.jpg 300w" sizes="(max-width: 857px) 100vw, 857px" /> <span style="color: #000000;">Ignore the fact that DOE entries are manufactured rather than being literal dates. I did this to easily create test data for each possible DOE. </span> <span style="color: #000000;">Look at column B.</span> <span style="color: #000000;">If the person has NOT already been confirmed&#8230;</span> <span style="color: #000000;">&#8220;A VLOOKUP begins, looking up the person&#8217;s length of service. </span></p>
<p><span style="color: #000000;">Once it finds the right row in the table, it needs to choose either column 3 (if they have been assessed) or column 4 (if they have not been assessed). The respective cells contain appropriate status information. </span></p>
<p><span style="color: #000000;">The choice of column is made in the VLOOKUP formula by the IF statement checking to see if an assessment has been made.&#8221;</span></p>
<p align="left"><span style="color: #000000;">If the person HAS been confirmed, it&#8217;s a simple status of &#8220;confirmed&#8221;.</span></p>
<p align="left"><span style="color: #000000;">So I hope you can see how once again VLOOKUP can be made to respond to second-level decisions by using different columns for the function&#8217;s return value. It&#8217;s similar to a couple of the challenges above.</span></p>
<p align="left"><span style="color: #000000;">Thanks for the challenge, Loti!</span></p>
<p align="left"><a href="/m/nasty-if-probation.xlsx">Download the Excel solution</a> (Excel 2007 format)</p>
</td>
</tr>
<tr>
<td valign="top">
<h3>Challenge 8</h3>
<p>I think you&#8217;ll like this one. Chris of a company in the U.K. wrote to say:</p>
<pre>Hi,
How would you suggest I set up the attached spreadsheet to avoid so many nested "IF"s"
Best Regards,
Chris</pre>
<p><img class="alignnone wp-image-332 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-challenge8.gif" alt="nasty-if-challenge8" width="713" height="123" /></p>
<p>Are you spotting any early problems yet? I&#8217;m sure you are. Now for the fun bit &#8211; look at the formula in A3&#8230;</p>
<p>=(IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;Ex-Stock&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;1 Week&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;2 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;3 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;4 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;5 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;6 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;7 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;8 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;9 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;10 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;11 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;12 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;13 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;14 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;15 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;16 Weeks&#8221;,B4:G4,0))), (IFERROR(INDEX($B$2:$G$2,1,(MATCH(&#8220;38 Weeks&#8221;,B4:G4,0))),A3) )))))))))))))))))))))))))))))))))))</p>
<h4>WOW!</h4>
<p>And it would have continued unto the crack of doom if he had included all the weeks between 17 and 37 &#8211; and thereon!Â Take a few minutes to try solving it yourself before reading on&#8230; As I replied to Chris:</p>
<pre>Wow, that was one really strangled formula you had there. 
First problem was that you were mixing numbers and text in cells, which prevents Excel doing numeric comparisons. 
Secondly, using text like "ex-stock" or "no bid" means nothing numerically to Excel. 
So, by replacing "ex-stock" with a really low number (0) and "no-bid" to an impossibly high number (999) you can find the lowest value with a simple MIN.Â  
Then use MATCH to find the corresponding column number containing that minimum value.Â  
Then use index to find the matching value in the list of supplier names. 
Hope that helps 
Cheers 
Mark</pre>
<p>The result, spookily enough, was very similar to a tongue-in-cheek solution I gave for a dodgy ITA exam question in my <a href="/p/postmortem-2008i.htm#Q12">2008 Postmortem Question 12</a>. This is how it looked after my facelift:</p>
<p><img class="alignnone wp-image-291 size-full" src="http://vceit.com/wp/wp-content/uploads/2015/06/nasty-if-challenge8b.gif" alt="nasty-if-challenge8b" width="801" height="207" /></p>
<p>The revised formula for A3 is far more easily chewable &#8211; and it can handle <strong>any number of suppliers </strong>with no extra code! =INDEX(suppliers,1,MATCH(B3,C3:J3,0)) Note that C2:J2 is named &#8216;suppliers&#8217; (I love named ranges) and B3 just contains MIN(C3:J3). Originally I had the MIN embedded in the A3 formula like this:</p>
<p>=INDEX(suppliers,1,MATCH(<strong>MIN(C3:J3)</strong>,C3:J3,0))</p>
<p>which worked just as well, but I thought it was getting a bit long, and I also thought it would be informative to have the value visible in column B. It just shows that you can hide subsidiary calculations inside bigger formulas, or have them separate. I usually prefer starting with smaller step-by-step calculations. When it&#8217;s all working, I can collapse the individual steps into one big formula. <strong>Walk-through:</strong> The MIN function finds the smallest value in the range. The MATCH function finds which column in C3:J3 contains that value.</p>
<p>Finally the INDEX formula looks in the corresponding column in row 1 to get the supplier&#8217;s name. See the <a href="/m/nasty-if-challenge8.xls">fixed Challenge 8 spreadsheet</a> (XLS format)</p>
</td>
</tr>
<tr>
<td valign="top">
<h4 align="center">Next challenger please&#8230;</h4>
</td>
</tr>
</tbody>
</table>
<p align="center"><span style="font-size: small;">Created 25 July 2006 </span></p>
<p>&nbsp;</p>
]]></content:encoded>
							<wfw:commentRss>http://vceit.com/wp/avoiding-nested-ifs-in-excel/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
		<item>
		<title>The CMS version of VCEIT.com begins&#8230;</title>
		<link>http://vceit.com/wp/the-cms-site/</link>
				<comments>http://vceit.com/wp/the-cms-site/#respond</comments>
				<pubDate>Mon, 08 Jun 2015 05:06:07 +0000</pubDate>
		<dc:creator><![CDATA[Mark Kelly]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://vceit.com/wp/?p=882</guid>
				<description><![CDATA[8 June 2015 &#8211; the day the old HTML/CSS version of the VCEIT.com site has started to fade away. The plan has been in the works for many years, and the advent of the new study design was incentive enough to take the leap and move to a new platform. The thought of struggling in &#8230; <a href="http://vceit.com/wp/the-cms-site/" class="more-link">Continue reading <span class="screen-reader-text">The CMS version of VCEIT.com begins&#8230;</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p><strong>8 June 2015</strong> &#8211; the day the old HTML/CSS version of the VCEIT.com site has started to fade away.</p>
<p>The plan has been in the works for many years, and the advent of the new study design was incentive enough to take the leap and move to a new platform. The thought of struggling in the mess of ancient HTML and CSS of the old site was enough to push me over the edge.</p>
<p>I spent ages evaluating many CMS platorms like Drupal, Joomla, Concrete5, SMF and only got more confused by options. In the end I just went for WordPress because it was popular and seemed to do the trick. Â We shall see.</p>
]]></content:encoded>
							<wfw:commentRss>http://vceit.com/wp/the-cms-site/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							</item>
	</channel>
</rss>

<!--
Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/


Served from: vceit.com @ 2019-09-18 20:16:13 by W3 Total Cache
-->